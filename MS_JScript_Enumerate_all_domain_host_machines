Enumerate All Domain Host Machines
This code retrieves the domain name of the currently logged-in user using the WScript.Network object. The domain name is then used to construct the LDAP path for the adsisearcher query.

The ADODB.Connection object is created without specifying a username or password, which allows the context of the currently logged-in user to be used.
The rest of the code is like the previous example, with the ADODB.Command object used to execute the adsisearcher query and retrieve the results.

Complete Syntax:

var network = new ActiveXObject('WScript.Network');
var domainName = network.UserDomain;
var searcher = new ActiveXObject('ADODB.Connection');
searcher.Provider = 'ADsDSOObject';
searcher.Properties('Encrypt Password') = true;
searcher.Open('ADs Provider');

var command = new ActiveXObject('ADODB.Command');
command.ActiveConnection = searcher;
command.CommandText = '<LDAP://' + domainName + '>;(&(objectCategory=computer));adspath,name,distinguishedname;';
var results = command.Execute();

while (!results.EOF) {
    var computer = results.Fields('name').Value;
    WScript.Echo(computer);
    results.MoveNext();
}

searcher.Close();

Result:

PS C:\Users\User1\Documents> cscript.exe //nologo .\Test3.js
WIN-CH4HJ7UU7Q5
LAB_WIN11_1
LAB-WIN11-2

You can output the results to text file.

PS C:\Users\User1\Documents> cscript.exe //nologo .\Test3.js > output1.txt
